name: CI
on:
  push:
    branches: [ master ]
  workflow_dispatch:
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Getting event
        run: cat  $GITHUB_EVENT_PATH
        shell: bash
        
      - name: Add lock
        run: |
          curl --location --request PUT 'https://api.github.com/repos/nkhanejatest/adf-dev/branches/myfeature/protection' \
          --header 'Accept: application/vnd.github.luke-cage-preview+json' \
          --header 'Authorization: Bearer {{ secrets.PAT }}' \
          --header 'Content-Type: application/json' \
          --data-raw '{
              "required_status_checks": {
                  "strict": false,
                  "contexts": [
                      "contexts"
                  ]
              },
              "enforce_admins": false,
              "required_pull_request_reviews": {
                  "dismissal_restrictions": {
                      "users": [],
                      "teams": []
                  },
                  "dismiss_stale_reviews": false,
                  "require_code_owner_reviews": false,
                  "required_approving_review_count": 1
              },
              "restrictions": {
                  "users": [],
                  "teams": [],
                  "apps": []
              }
          }'
        shell: bash
          
